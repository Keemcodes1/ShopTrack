import{r as u,u as b,a as v,j as e,m as w,I as h,L as g,B as N}from"./index-57ec44c4.js";import{I as f}from"./input-f8fb606e.js";import{L as j}from"./label-d697d8cb.js";import{C as S,a as k,b as T,c as I,d as C,e as P}from"./card-34546aba.js";const L="http://localhost:8000/api",A=()=>localStorage.getItem("accessToken"),E=(o,r)=>{localStorage.setItem("accessToken",o),r&&localStorage.setItem("refreshToken",r)},F=async(o,r={})=>{const n=A(),c={"Content-Type":"application/json",...r.headers};n&&(c.Authorization=`Bearer ${n}`);const a=await fetch(`${L}${o}`,{...r,headers:c});if(!a.ok){let s;try{s=await a.json()}catch{s={detail:a.statusText}}console.error("API Error:",s);const i=new Error(s.detail||`HTTP error! status: ${a.status}`);throw i.status=a.status,i.data=s,i}return a.status===204?null:a.json()},_=()=>{const[o,r]=u.useState(""),[n,c]=u.useState(""),[a,s]=u.useState(!1),i=b(),{toast:d}=v(),y=async l=>{var p,x;l.preventDefault(),s(!0);try{const t=await F("/token/",{method:"POST",body:JSON.stringify({username:o,password:n})});E(t.access,t.refresh),d({title:"Login Successful!",description:"Welcome back to ShopTrackPOS.",variant:"default"}),i("/")}catch(t){console.error("Login failed:",t);let m="An unexpected error occurred. Please try again.";t.status===401?m=((p=t.data)==null?void 0:p.detail)||"Invalid credentials. Please check your email and password.":(x=t.data)!=null&&x.detail&&(m=t.data.detail),d({title:"Login Failed",description:m,variant:"destructive"})}finally{s(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-primary/20 via-background to-secondary/20",children:e.jsx(w.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:e.jsxs(S,{className:"w-full max-w-md shadow-2xl glass-card",children:[e.jsxs(k,{className:"text-center",children:[e.jsx(h.logo,{className:"mx-auto h-12 w-12 mb-4"}),e.jsx(T,{className:"text-3xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-500",children:"Welcome Back!"}),e.jsx(I,{className:"text-muted-foreground",children:"Sign in to access your ShopTrackPOS dashboard."})]}),e.jsx(C,{children:e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"email",children:"Username or Email"}),e.jsx(f,{id:"email",type:"text",placeholder:"your_username or you@example.com",value:o,onChange:l=>r(l.target.value),required:!0,disabled:a,className:"bg-background/70"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{htmlFor:"password",children:"Password"}),e.jsx(g,{to:"#",className:"text-sm text-primary hover:underline",children:"Forgot password?"})]}),e.jsx(f,{id:"password",type:"password",placeholder:"••••••••",value:n,onChange:l=>c(l.target.value),required:!0,disabled:a,className:"bg-background/70"})]}),e.jsxs(N,{type:"submit",className:"w-full font-semibold text-lg py-3",disabled:a,children:[a?e.jsx(h.settings,{className:"mr-2 h-5 w-5 animate-spin"}):e.jsx(h.login,{className:"mr-2 h-5 w-5"}),a?"Signing In...":"Sign In"]})]})}),e.jsxs(P,{className:"flex flex-col items-center space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(g,{to:"/register",className:"font-medium text-primary hover:underline",children:"Sign up here"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground/70",children:["© ",new Date().getFullYear()," ShopTrackPOS. All rights reserved."]})]})]})})})};export{_ as default};
